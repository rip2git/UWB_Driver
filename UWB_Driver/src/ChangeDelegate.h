#ifndef CHANGE_DELEGATE_H
#define CHANGE_DELEGATE_H


/* -----------------------------------------------------------------------------------------
 * Interface for _ChangeDelegate & ChangeDelegate
 * -----------------------------------------------------------------------------------------
 * */
class IChangeDelegate {
public:
	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	virtual ~IChangeDelegate() {}

	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	virtual bool Change() const = 0;
};


/* -----------------------------------------------------------------------------------------
 * Temporary class needed to hide content of the validation object
 * -----------------------------------------------------------------------------------------
 * */
template <class OBJECT>
class _ChangeDelegate : public IChangeDelegate {
	typedef bool (OBJECT::*pChangeFunc)(void);

public:
	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	_ChangeDelegate(OBJECT *obj, pChangeFunc obj_Change)
	{
		this->obj = obj;
		this->obj_Change = obj_Change;
	}

	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	virtual bool Change() const
	{
		return (obj != 0)? (obj->*obj_Change)() : 0;
	}

private:
	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	OBJECT *obj;

	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	pChangeFunc obj_Change;
};


/* -----------------------------------------------------------------------------------------
 * Provides the ability to change something without knowing
 * *** the content of the validation object; object should
 * *** provides interface for changing.
 * -----------------------------------------------------------------------------------------
 * */
class ChangeDelegate {
public:
	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	ChangeDelegate(IChangeDelegate *iChDeleg = 0)
	{
		this->iChDeleg = iChDeleg;
	}

	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	bool Change() const
	{
		return (iChDeleg != 0)? iChDeleg->Change() : 0;
	}

	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	ChangeDelegate& operator=(IChangeDelegate* iChDeleg)
	{
		this->iChDeleg = iChDeleg;
		return *this;
	}

private:
	/* -------------------------------------------------------------------------------------
	 * -------------------------------------------------------------------------------------	 *
	 * */
	IChangeDelegate *iChDeleg;
};


/* -----------------------------------------------------------------------------------------
 * Provides to define change method are independent of object content
 * -----------------------------------------------------------------------------------------
 * */
template <class OBJECT>
IChangeDelegate* NewChangeDelegate(OBJECT* obj, bool (OBJECT::*pChangeFunc)(void))
{
	return new _ChangeDelegate<OBJECT> (obj, pChangeFunc);
}


#endif
